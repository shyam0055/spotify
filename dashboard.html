<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spotify-Web Player: Music for everyone</title>
    <link rel="icon" href="assets/images/logo.svg" type="image/svg+xml" />
    <!-- <link rel="stylesheet" href="assets/css/style.css" /> -->
    <link rel="stylesheet" href="assets/css/dashboard.css" />
  </head>
  <body>
    <!-- POPUP MENU: Mobile menu with user info -->
    <div class="popmenu" id="popupMenu">
      <div class="men">
        <!-- User Info Section for mobile -->
        <div class="mobile-user-info" id="mobileUserInfo">
          <div class="mobile-avatar" id="mobileUserAvatar"></div>
          <div class="mobile-user-details">
            <h4 id="mobileUserName">Loading...</h4>
            <p id="mobileUserEmail">Loading...</p>
          </div>
        </div>
        <div class="mobile-menu-divider"></div>
        <!-- Navigation Links -->
        <a href="#" class="nav-link">Premium</a>
        <a href="#" class="nav-link">Support</a>
        <a href="#" class="nav-link">Download</a>
        <div class="mobile-menu-divider"></div>
        <button class="install-button">Install App</button>
        <a href="profile.html" class="nav-link">Profile</a>
        <a href="#" class="nav-link logout-mobile" onclick="logout()">Logout</a>
      </div>
    </div>

    <!-- TOP BAR -->
    <div class="appbar">
      <div class="appbar-left">
        <img src="assets/images/logo.svg" alt="spotify" class="logo" />
      </div>

      <div class="appbar-center">
        <a href="dashboard.html" class="home-button" aria-label="Home">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M12.5 3.247a1 1 0 0 0-1 0L4 7.577V20h4.5v-6a1.5 1.5 0 0 1 1.5-1.5h4a1.5 1.5 0 0 1 1.5 1.5v6H20V7.577l-7.5-4.33zm-2-1.732a3 3 0 0 1 3 0l7.5 4.33a2 2 0 0 1 1-1.732V20a2 2 0 0 1-2 2h-5a1 1 0 0 1-1-1v-5h-2v5a1 1 0 0 1-1 1H4a2 2 0 0 1-2-2V7.577a2 2 0 0 1 1-1.732l7.5-4.33z"
            />
          </svg>
        </a>

        <div class="search-container">
          <input
            type="search"
            id="searchbar"
            placeholder="What do you want to play?"
          />
          <button class="search-button" aria-label="search">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M10.533 1.279c-5.18 0-9.407 4.14-9.407 9.279s4.226 9.279 9.407 9.279c2.234 0 4.29-.77 5.907-2.058l4.353 4.353a1 1 0 1 0 1.414-1.414l-4.344-4.344a9.157 9.157 0 0 0 2.077-5.816c0-5.14-4.226-9.28-9.407-9.28zm-7.407 9.279c0-4.006 3.302-7.28 7.407-7.28s7.407 3.274 7.407 7.28-3.302 7.279-7.407 7.279-7.407-3.273-7.407-7.28z"
              />
            </svg>
          </button>
        </div>

        <!-- Voice Search Section (Updated) -->
        <div class="search-mike">
          <button
            id="voiceBtn"
            class="voice-btn"
            aria-label="Voice search"
            title="Search with lyrics"
            aria-pressed="false"
          >
            <img src="assets/images/mike.png" alt="🎙️" class="mike" />
          </button>
          <p>Search with lyrics</p>
        </div>
      </div>

      <!-- RIGHT SECTION: Profile dropdown for logged in users -->
      <div class="appbar-right">
        <div class="user-options">
          <a href="#" class="nav-link">Premium</a>
          <a href="#" class="nav-link">Support</a>
          <a href="#" class="nav-link">Download</a>
          <span class="separator">|</span>
          <button class="install-button">Install App</button>

          <!-- PROFILE DROPDOWN: Shows user info and logout -->
          <div class="profile-section">
            <div class="profile-dropdown">
              <button
                class="profile-button"
                id="profileButton"
                onclick="toggleProfile()"
              >
                <div class="profile-avatar" id="userAvatar"></div>
                <span class="profile-name" id="userName">Loading...</span>
                <svg
                  class="profile-arrow"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path d="M7 10l5 5 5-5z" />
                </svg>
              </button>

              <div class="profile-menu" id="profileMenu">
                <div class="profile-header">
                  <div class="profile-menu-avatar" id="userMenuAvatar"></div>
                  <div class="profile-info">
                    <h4 id="userFullName">Loading...</h4>
                    <p id="userEmail">Loading...</p>
                  </div>
                </div>
                <div class="profile-divider"></div>

                <a href="profile.html" class="profile-menu-item">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                    />
                  </svg>
                  Profile
                </a>

                <a href="#" class="profile-menu-item">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"
                    />
                  </svg>
                  Settings
                </a>

                <a href="#" class="profile-menu-item">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M11,18h2v-2h-2V18z M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M13,16h-2v-6h2V16z M13,8h-2V6h2V8z"
                    />
                  </svg>
                  Help & Support
                </a>

                <div class="profile-divider"></div>

                <a href="#" class="profile-menu-item logout" onclick="logout()">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"
                    />
                  </svg>
                  Logout
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="menubar">
        <div class="menu-toggle" id="menuToggle" onclick="toggleMenu()">
          &#9776;
        </div>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="container">
      <!-- LEFT SIDEBAR -->
      <div class="library border">
        <div class="library-text">
          Your Library
          <button class="add-btn" aria-label="Add">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          </button>
        </div>

        <div class="left-in border">
          <div class="box">
            <h3>Create your first playlist</h3>
            <p>It's easy, we'll help you</p>
            <button>Create playlist</button>
          </div>
          <div class="box">
            <h3>Let's find some podcasts to follow</h3>
            <p>We'll keep you updated on new episodes</p>
            <button>Browse podcasts</button>
          </div>

          <!-- NOW PLAYING SECTION -->
          <div class="now-playing-info">
            <h3 id="current-song-title">No song playing</h3>
            <p id="current-artist">Select a song to start playing</p>
            <div class="now-playing-image">
              <img
                id="current-song-image"
                src=""
                alt="Current song"
                style="display: none"
              />
            </div>
          </div>
        </div>

        <div class="footer">
          <div class="footer-links">
            <a href="legal.html">Legal</a>
            <a href="privacy-center.html">Safety & Privacy Center</a>
            <a href="privacy-policy.html">Privacy Policy</a>
            <a href="cookies.html">Cookies</a>
            <a href="about-ads.html">About Ads</a>
            <a href="accessibility.html">Accessibility</a>
          </div>
          <a href="#" class="language-selector">English</a>
        </div>
      </div>

      <!-- MAIN MUSIC SECTION -->
      <div class="music">
        <div class="trending">
          <h1 class="trdnow">Trending Now</h1>

          <!-- ALBUM CARDS -->
          <div class="cards">
            <div class="card" data-album="sanam teri kasam">
              <a
                href="#"
                onclick="playAlbum('sanam teri kasam'); return false;"
              >
                <img
                  src="assets/images/sanamterikasam.png"
                  alt="Sanam Teri Kasam"
                />
              </a>
              <h3>Sanam Teri Kasam</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="coolie">
              <a href="#" onclick="playAlbum('coolie'); return false;">
                <img src="assets/images/coolie.png" alt="Coolie" />
              </a>
              <h3>Coolie</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="kushagara">
              <a href="#" onclick="playAlbum('kushagara'); return false;">
                <img src="assets/images/findingher.png" alt="Finding Her" />
              </a>
              <h3>Finding Her</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="jawani">
              <a href="#" onclick="playAlbum('jawani'); return false;">
                <img src="assets/images/jawani.png" alt="Jawani" />
              </a>
              <h3>Jawani</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="priya darshini">
              <a href="#" onclick="playAlbum('priya darshini'); return false;">
                <img src="assets/images/kiliye.png" alt="Kiliye" />
              </a>
              <h3>Kiliye</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="ranjhan">
              <a href="#" onclick="playAlbum('ranjhan'); return false;">
                <img src="assets/images/ranjhan.png" alt="Ranjhan" />
              </a>
              <h3>Ranjhan</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="hummarjayenge">
              <a href="#" onclick="playAlbum('hummarjayenge'); return false;">
                <img src="assets/images/ashiq.png" alt="Hum Mar Jayenge" />
              </a>
              <h3>Hum Mar Jayenge</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="sundari">
              <a href="#" onclick="playAlbum('sundari'); return false;">
                <img src="assets/images/sundari.png" alt="Sundari" />
              </a>
              <h3>Sundari</h3>
              <p><span>Various Artists</span></p>
            </div>

            <div class="card" data-album="younggoat">
              <a href="#" onclick="playAlbum('younggoat'); return false;">
                <img src="assets/images/younggoat.png" alt="Young Goat" />
              </a>
              <h3>Young Goat</h3>
              <p><span>Various Artists</span></p>
            </div>
          </div>

          <!-- ARTISTS SECTION -->
          <div class="trendingartist">
            <h3 class="trdnow">Popular Artists</h3>
            <div class="profile">
              <div class="photo">
                <a href="artist.html?name=anirudh">
                  <img src="assets/images/anirudh.png" alt="Anirudh" />
                </a>
                <h3>Anirudh</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=ar_rahman">
                  <img src="assets/images/arrahaman.png" alt="Ar Rahamanh" />
                </a>
                <h3>Ar Rahamanh</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=sp_balasubrahmanyam">
                  <img
                    src="assets/images/balasubhramanyam .png"
                    alt="Balasubhramanyam"
                  />
                </a>
                <h3>Balasubhramanyam</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=chitra">
                  <img src="assets/images/chitra.png" alt="Chitra" />
                </a>
                <h3>Chitra</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=dsp">
                  <img src="assets/images/dsp.png" alt="Dsp" />
                </a>
                <h3>DSP</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=keeravani">
                  <img src="assets/images/keeravani.png" alt="keeravani" />
                </a>
                <h3>keeravani</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=ss_thaman">
                  <img src="assets/images/ssthaman.png" alt="SS Thaman" />
                </a>
                <h3>SS Thaman</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=billie_eilish">
                  <img
                    src="assets/images/billieeilish.png"
                    alt="billieeilish"
                  />
                </a>
                <h3>billieeilish</h3>
              </div>
              <div class="photo">
                <a href="artist.html?name=justin_bieber">
                  <img
                    src="assets/images/justinbeiber.png"
                    alt="justinbeiber"
                  />
                </a>
                <h3>justinbeiber</h3>
              </div>
            </div>
          </div>
        </div>

        <!-- BOTTOM PLAYER BAR -->
        <div class="playbar">
          <div class="playbuttons">
            <img
              src="assets/images/previous.svg"
              alt="⏮"
              id="previousBtn"
              onclick="previousSong()"
              style="cursor: pointer"
            />
            <img
              src="assets/images/play.svg"
              alt="▶"
              id="playPauseBtn"
              onclick="togglePlayPause()"
              style="cursor: pointer"
            />
            <img
              src="assets/images/next.svg"
              alt="⏭"
              id="nextBtn"
              onclick="nextSong()"
              style="cursor: pointer"
            />
          </div>

          <div class="song-progress">
            <span id="currentTime">0:00</span>
            <input
              type="range"
              id="progressBar"
              min="0"
              max="100"
              value="0"
              onchange="seekTo()"
            />
            <span id="duration">0:00</span>
          </div>

          <div class="volume-control">
            <img src="assets/images/volume.svg" alt="🔊" />
            <input
              type="range"
              id="volumeSlider"
              min="0"
              max="100"
              value="50"
              onchange="setVolume()"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- HIDDEN AUDIO ELEMENT -->
    <audio id="player" style="display: none"></audio>

    <!-- Include the music player JavaScript -->
    <script src="script.js"></script>
    <script>
      // Load user data when page loads
      window.onload = function () {
        loadUserData();
      };

      function loadUserData() {
        const userData = JSON.parse(localStorage.getItem("userData"));
        const isLoggedIn = localStorage.getItem("isLoggedIn");

        // If not logged in or no user data, redirect to login
        if (!isLoggedIn || !userData) {
          window.location.href = "index.html";
          return;
        }

        // Generate avatar with user's initials
        const initials = userData.fullName
          ? userData.fullName
              .split(" ")
              .map((n) => n[0])
              .join("")
              .toUpperCase()
          : "U";

        const avatarColors = [
          "#1db954",
          "#ff6b35",
          "#f7931e",
          "#bc5a94",
          "#00a8cc",
        ];
        const avatarColor =
          avatarColors[Math.floor(Math.random() * avatarColors.length)];

        // Update profile elements in main navbar
        document.getElementById("userName").textContent =
          userData.fullName || "User";
        document.getElementById("userFullName").textContent =
          userData.fullName || "User";
        document.getElementById("userEmail").textContent = userData.email || "";

        // Update mobile menu elements
        document.getElementById("mobileUserName").textContent =
          userData.fullName || "User";
        document.getElementById("mobileUserEmail").textContent =
          userData.email || "";

        // Create avatar elements for all locations
        const avatarElements = [
          document.getElementById("userAvatar"),
          document.getElementById("userMenuAvatar"),
          document.getElementById("mobileUserAvatar"),
        ];

        avatarElements.forEach((avatar, index) => {
          if (avatar) {
            avatar.style.backgroundColor = avatarColor;
            avatar.style.color = "white";
            avatar.style.display = "flex";
            avatar.style.alignItems = "center";
            avatar.style.justifyContent = "center";
            avatar.style.fontWeight = "bold";
            avatar.style.borderRadius = "50%";

            // Different sizes for different avatars
            if (index === 0) {
              // userAvatar
              avatar.style.fontSize = "14px";
              avatar.style.width = "32px";
              avatar.style.height = "32px";
            } else if (index === 1) {
              // userMenuAvatar
              avatar.style.fontSize = "20px";
              avatar.style.width = "48px";
              avatar.style.height = "48px";
            } else {
              // mobileUserAvatar
              avatar.style.fontSize = "16px";
              avatar.style.width = "40px";
              avatar.style.height = "40px";
            }

            avatar.textContent = initials;
          }
        });
      }

      function logout() {
        localStorage.removeItem("userData");
        localStorage.removeItem("isLoggedIn");
        window.location.href = "index.html";
      }

      function toggleMenu() {
        const popupMenu = document.getElementById("popupMenu");
        const menuToggle = document.getElementById("menuToggle");

        if (popupMenu.classList.contains("active")) {
          popupMenu.classList.remove("active");
          menuToggle.innerHTML = "&#9776;";
        } else {
          popupMenu.classList.add("active");
          menuToggle.innerHTML = "&#10005;";
        }
      }
    </script>
  </body>
</html>
